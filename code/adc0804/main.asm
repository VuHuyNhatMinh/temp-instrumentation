ORG 000H

MAIN:
	LCALL SETUP
	LCALL LOOP

SETUP:
	MOV P2, #11111000B
	MOV DPTR, #CODE7SEG
	RET
	
LOOP:
	LCALL CONVERT
	SJMP LOOP

CONVERT:
	CLR P2.4	//wr
	LCALL DELAY_10	
	SETB P2.4	//wr
	
	JB P2.3, $	//wait
	
	CLR P2.5	//rd
	LCALL DELAY_10


	MOV A, P1
	LCALL DISPLAY
	SETB P2.5	//rd
	
	RET
	
DISPLAY:
	MOV B, #10
	DIV AB
	
	SETB P2.0
	MOVC A, @A+DPTR
	MOV P0, A
	LCALL DELAY_10
	CLR P2.0
	
	SETB P2.1
	MOV A, B
	MOVC A, @A+DPTR
	MOV P0, A
	LCALL DELAY_10
	CLR P2.1
	
	RET

DELAY_10:
	MOV R7, #10
	DJNZ R7, $
	RET
	
CODE7SEG:
	DB 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90
END